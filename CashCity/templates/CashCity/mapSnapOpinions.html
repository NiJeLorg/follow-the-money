{% load staticfiles %}

<!-- load thumbnail mini-maps -->
{% for mapSnap in mapSnaps %}
	<div id="map{{ mapSnap.id }}" num="{{ mapSnap.id }}" class="map-thumbnail mapSnapSelect_1 mediaSelect"></div>
{% endfor %}

	<script type="text/javascript">				
		function getMapSnaps() {
			{% for mapSnap in mapSnaps %}
		    	var map{{ mapSnap.id }} = new CityDigitsMapThumb({{ mapSnap.id }},{{ mapSnap.latitude }},{{ mapSnap.longitude }},{{ mapSnap.zoom }});
						
				var MapLayer = '{{ mapSnap.MapLayer }}';	
				var LOC1 = '{{ mapSnap.PawnShops }}';
				var LOC2 = '{{ mapSnap.CheckCashing }}';
				var LOC3 = '{{ mapSnap.WireTransfer }}';
				var LOC4 = '{{ mapSnap.Banks }}';
				var LOC5 = '{{ mapSnap.McDonalds }}';
				var LOC6 = '{{ mapSnap.SubwayLines }}';
				var MEDIA = '{{ mapSnap.Media }}';
				
				// add in layers that were turned on
				if (MapLayer == 'legendpoverty') {
					map{{ mapSnap.id }}.load_MAP1_POP_POVERTY(map{{ mapSnap.id }});	
				} 
				if (MapLayer == 'legendmedhhinc') {
					map{{ mapSnap.id }}.load_MAP2_MED_HH_INCOME(map{{ mapSnap.id }});	
				}
				if (MapLayer == 'legendunemploy') {
					map{{ mapSnap.id }}.load_MAP3_PCT_UNEMPLOYED(map{{ mapSnap.id }});	
				} 
				if (MapLayer == 'legendforeignborn') {
					map{{ mapSnap.id }}.load_MAP4_PCT_FOREIGN_BORN(map{{ mapSnap.id }});	
				} 
				if (MapLayer == 'legendAFIpersqmi') {
					map{{ mapSnap.id }}.load_CREATEMAP1_AFI_PER_SQMILE(map{{ mapSnap.id }});	
				} 
				if (MapLayer == 'legendbankspersqmi') {
					map{{ mapSnap.id }}.load_CREATEMAP2_BANKS_PER_SQMILE(map{{ mapSnap.id }});	
				} 
				if (MapLayer == 'legendpawnsqmi') {
					map{{ mapSnap.id }}.load_CREATEMAP3_PAWN_SHOPS_PER_SQMILE(map{{ mapSnap.id }});	
				} 
				if (MapLayer == 'legendmcdonaldspersqi') {
					map{{ mapSnap.id }}.load_CREATEMAP4_MCDONALDS_PER_SQMILE(map{{ mapSnap.id }});	
				} 
				if (MapLayer == 'legendhouseholdsperAFI') {
					map{{ mapSnap.id }}.load_CREATEMAP5_HH_PER_AFI(map{{ mapSnap.id }});	
				} 
				if (MapLayer == 'legendhouseholdsperbank') {
					map{{ mapSnap.id }}.load_CREATEMAP6_HH_PER_BANK(map{{ mapSnap.id }});	
				} 
				if (MapLayer == 'legendhouseholdsperMcD') {
					map{{ mapSnap.id }}.load_CREATEMAP7_HH_PER_MCDONALDS(map{{ mapSnap.id }});	
				} 
				if (MapLayer == 'legendhouseholdsperpawn') {
					map{{ mapSnap.id }}.load_CREATEMAP8_HH_PER_PAWN_SHOP(map{{ mapSnap.id }});	
				} 
				if (MapLayer == 'legendAFIsperbank') {
					map{{ mapSnap.id }}.load_CREATEMAP9_AFIS_PER_BANK(map{{ mapSnap.id }});	
				} 
				if (MapLayer == 'legendbanksperAFIs') {
					map{{ mapSnap.id }}.load_CREATEMAP10_BANKS_PER_AFI(map{{ mapSnap.id }});	
				}

				if (LOC1 == 'True') {
					map{{ mapSnap.id }}.load_LOC1_PAWN_SHOPS(map{{ mapSnap.id }});	
				}
				// add in layers that were turned on
				if (LOC2 == 'True') {
					map{{ mapSnap.id }}.load_LOC2_CHECK_CASHING(map{{ mapSnap.id }});	
				}
				// add in layers that were turned on
				if (LOC3 == 'True') {
					map{{ mapSnap.id }}.load_LOC3_WIRE_TRANSFER(map{{ mapSnap.id }});	
				}
				// add in layers that were turned on
				if (LOC4 == 'True') {
					map{{ mapSnap.id }}.load_LOC4_BANKS(map{{ mapSnap.id }});	
				}
				// add in layers that were turned on
				if (LOC5 == 'True') {
					map{{ mapSnap.id }}.load_LOC5_MCDONALDS(map{{ mapSnap.id }});	
				}
				// add in layers that were turned on
				if (LOC6 == 'True') {
					map{{ mapSnap.id }}.load_LOC6_SUBWAY_LINES(map{{ mapSnap.id }});	
				}			

				// add in layers that were turned on
				if (MEDIA == 'True') {
					map{{ mapSnap.id }}.loadMedia(map{{ mapSnap.id }});	
				}			
			
			{% endfor %}
						
			// ensure thumbnail maps render in modals
			$('.refreshMap').click(function() {
				// use invalidate size to make maps show appropriately
				{% for mapSnap in mapSnaps %}
					map{{ mapSnap.id }}.map.invalidateSize(false);
				{% endfor %}
			});
				
			
		}					
		
		$( window ).load(function() {
			getMapSnaps();
		});
	</script>
