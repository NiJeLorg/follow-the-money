{% load staticfiles %}

	<script type="text/javascript">	
	var activeMap{{ mapSnap.id }} = null;			
		$( window ).load(function() {
	    	var map{{ mapSnap.id }} = new CityDigitsMapOpinion({{ section.sectionNumber }},{{ mapSnap.latitude }},{{ mapSnap.longitude }},{{ mapSnap.zoom }});
			activeMap{{ mapSnap.id }} = map{{ mapSnap.id }};
			
			// set map state variables
			var MapLayer{{ mapSnap.id }} = '{{ mapSnap.MapLayer }}';	
			var LOC1{{ mapSnap.id }} = '{{ mapSnap.PawnShops }}';
			var LOC2{{ mapSnap.id }} = '{{ mapSnap.CheckCashing }}';
			var LOC3{{ mapSnap.id }} = '{{ mapSnap.WireTransfer }}';
			var LOC4{{ mapSnap.id }} = '{{ mapSnap.Banks }}';
			var LOC5{{ mapSnap.id }} = '{{ mapSnap.McDonalds }}';
			var LOC6{{ mapSnap.id }} = '{{ mapSnap.SubwayLines }}';
			var MEDIA{{ mapSnap.id }} = '{{ mapSnap.MEDIA }}';
			
			// load the layers if neccesary
			if (MapLayer{{ mapSnap.id }}) {
				map{{ mapSnap.id }}.loadLayers();
				map{{ mapSnap.id }}.loadCreateMapLayers();
			}

			if (LOC1{{ mapSnap.id }} || LOC2{{ mapSnap.id }} || LOC3{{ mapSnap.id }} || LOC4{{ mapSnap.id }} || LOC5{{ mapSnap.id }} || LOC6{{ mapSnap.id }} || LOC7{{ mapSnap.id }}) {
				map{{ mapSnap.id }}.loadMarkers();
			}
			
			if (MEDIA{{ mapSnap.id }}) {
				map{{ mapSnap.id }}.loadMedia();
			}
						
			// add in layers that were turned on
			if (MapLayer{{ mapSnap.id }} == 'legendpoverty') {
				CityDigitsMapOpinion.loadLayerFor('MAP1', map{{ mapSnap.id }});	
			} 
			if (MapLayer{{ mapSnap.id }} == 'legendmedhhinc') {
				CityDigitsMapOpinion.loadLayerFor('MAP2', map{{ mapSnap.id }});	
			}
			if (MapLayer{{ mapSnap.id }} == 'legendunemploy') {
				CityDigitsMapOpinion.loadLayerFor('MAP3', map{{ mapSnap.id }});	
			} 
			if (MapLayer{{ mapSnap.id }} == 'legendforeignborn') {
				CityDigitsMapOpinion.loadLayerFor('MAP4', map{{ mapSnap.id }});	
			} 
			if (MapLayer{{ mapSnap.id }} == 'legendAFIpersqmi') {
				CityDigitsMapOpinion.loadLayerFor('CREATEMAP1', map{{ mapSnap.id }});	
			} 
			if (MapLayer{{ mapSnap.id }} == 'legendbankspersqmi') {
				CityDigitsMapOpinion.loadLayerFor('CREATEMAP2', map{{ mapSnap.id }});	
			} 
			if (MapLayer{{ mapSnap.id }} == 'legendpawnsqmi') {
				CityDigitsMapOpinion.loadLayerFor('CREATEMAP3', map{{ mapSnap.id }});	
			} 
			if (MapLayer{{ mapSnap.id }} == 'legendmcdonaldspersqi') {
				CityDigitsMapOpinion.loadLayerFor('CREATEMAP4', map{{ mapSnap.id }});	
			} 
			if (MapLayer{{ mapSnap.id }} == 'legendhouseholdsperAFI') {
				CityDigitsMapOpinion.loadLayerFor('CREATEMAP5', map{{ mapSnap.id }});	
			} 
			if (MapLayer{{ mapSnap.id }} == 'legendhouseholdsperbank') {
				CityDigitsMapOpinion.loadLayerFor('CREATEMAP6', map{{ mapSnap.id }});	
			} 
			if (MapLayer{{ mapSnap.id }} == 'legendhouseholdsperMcD') {
				CityDigitsMapOpinion.loadLayerFor('CREATEMAP7', map{{ mapSnap.id }});	
			} 
			if (MapLayer{{ mapSnap.id }} == 'legendhouseholdsperpawn') {
				CityDigitsMapOpinion.loadLayerFor('CREATEMAP8', map{{ mapSnap.id }});	
			} 
			if (MapLayer{{ mapSnap.id }} == 'legendAFIsperbank') {
				CityDigitsMapOpinion.loadLayerFor('CREATEMAP9', map{{ mapSnap.id }});	
			} 
			if (MapLayer{{ mapSnap.id }} == 'legendbanksperAFIs') {
				CityDigitsMapOpinion.loadLayerFor('CREATEMAP10', map{{ mapSnap.id }});	
			}
			
			function addLocations() {
				if (LOC1{{ mapSnap.id }} == 'True') {
					CityDigitsMapOpinion.loadLocationsLayerFor('LOC1', activeMap{{ mapSnap.id }});	
				}
				// add in layers that were turned on
				if (LOC2{{ mapSnap.id }} == 'True') {
					CityDigitsMapOpinion.loadLocationsLayerFor('LOC2', activeMap{{ mapSnap.id }});	
				}
				// add in layers that were turned on
				if (LOC3{{ mapSnap.id }} == 'True') {
					CityDigitsMapOpinion.loadLocationsLayerFor('LOC3', activeMap{{ mapSnap.id }});	
				}
				// add in layers that were turned on
				if (LOC4{{ mapSnap.id }} == 'True') {
					CityDigitsMapOpinion.loadLocationsLayerFor('LOC4', activeMap{{ mapSnap.id }});	
				}
				// add in layers that were turned on
				if (LOC5{{ mapSnap.id }} == 'True') {
					CityDigitsMapOpinion.loadLocationsLayerFor('LOC5', activeMap{{ mapSnap.id }});	
				}
				// add in layers that were turned on
				if (LOC6{{ mapSnap.id }} == 'True') {
					CityDigitsMapOpinion.loadLocationsLayerFor('LOC6', activeMap{{ mapSnap.id }});	
				}			
				// add in layers that were turned on
				if (MEDIA{{ mapSnap.id }} == 'True') {
					CityDigitsMapOpinion.loadMediaLayers(activeMap);	
				}			

			}

			
			setTimeout ( addLocations, 5000);
		
		});
	</script>
